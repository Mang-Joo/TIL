# 잠금

MySQL에서 잠금은 크게 스토리지 엔진 레벨과 MySQL 엔진 레벨로 나눌 수 있다.

MySQL레벨에서의 잠금은 모든 스토리지 엔진에 영향을 미치지만, 스토리지 엔진 레벨의 잠금은 스토리지 엔진 간 테이블의 구조를 잠그는 메타데이터 락 그리고 네임드 락 기능을 제공한다.

## 글로벌 락

글로벌 락은 MySQL에서 지원하는 잠금 가운데 범위가 가장 큰 잠금이다.

한 세션에서 글로벌 락을 획득하면 다른 세션에서 SELECT를 제외한 대부분의 쿼리는 글로벌 락이 해제될 때까지 해당 문장이 대기 상태로 남는다.\
글로벌 락이 영향을 미치는 범위는 MySQL 서버 전체이며, 작업 대상 테이블이나 데이터베이스가 다르더라도 동일하게 영향을 미친다.\
일관적으로 백업을 받아야 할 때 정도로 사용한다.

## 테이블 락

개별 테이블 단위로 설정되는 잠금이며, 명시적 또는 묵시적으로 특정 테이블 락을 획득 할 수 있다.\
MyISAM 뿐만 아니라, InnoDB 스토리지 엔진을 사용하는 테이블도 동일하게 설정할 수 있다.

> 명시적인 테이블 락은 특별한 상황이 아니라면 사용되지 않기 때문에 따로 명령어를 작성하진 않겠다.

MyISAM이나 Memory엔진의 경우 테이블에 데이터를 변경하는 쿼리를 실행하면 발생한다.\
서버가 데이터가 변경되는 테이블에 락을 걸고 데이터를 변경한 후, 즉시 잠금을 해제한다.

하지만 InnoDB는 레코드 기반의 잠금을 제공하기 때문에 단순 데이터 변경 쿼리로 인해 테이블 락이 설정되지 않고, 스키마를 변경하는 쿼리의 경우에만 영향을 미치게 된다.

## 네임드 락

임의의 문자열에 대해 잠금을 설정할 수 있다.\
잠금의 특징은 대상이 테이블이나 레코드 또는 데이터베이스 객체가 아니다.\
네임드 락은 단순히 사용자가 지정한 문자열에 대해 획득하고 반납하는 잠금이다.\
즉, 해당 문자열 자체를 잠금을 건다는 의미로 받아들였다.

## 메타데이터 락

데이터베이스 객체의 이름이나 구조를 변경하는 경우에 획득하는 잠금이다.\
테이블의 이름을 변경하는 경우나 테이블 컬럼이 변경되는 경우 해당 잠금이 발생한다.
