# 언두 로그

스토리지 엔진은 트랜잭션과 격리 수준을 보장하기 위해 DML로 변경되기 이전 버전의 데이터를 별도로 백어밯ㄴ다.\
이렇게 백업된 데이터를 `언두 로그(Undo Log)`라고 한다.

* 트랜잭션 보장\
  트랜잭션이 롤백되면 변경되기 이전의 데이터로 변경해야 하는데 이 때 언두 로그의 데이터를 사용한다.
* 격리 수준 보장\
  특정 터넥션에서 데이터를 변경하는 도중에 다른 커넥션에서 데이터를 조회하면 언두 로그에 백업해둔 데이터를 읽어서 반환한다.

언두 영역은 트랜잭션을 커밋하지 않아도 실제 데이터 파일 내용은 변경된다.\
예를 들어, '홍길동'이라는 데이터를 '망주'로 변경하였을 때 언두 영역에는 '홍길동'이라는 데이터가 백업되는 것이다.\
이 상태에서 사용자가 커밋을 하게 되면 데이터는 '망주'로 유지되고, 롤백을 하게 되면 언두 영역에 있는 '홍길동'이라는 이름으로 다시 복구 하는 것이다.

대용량 데이터를 처리하는 트랜잭션이나 트랜잭션이 오랜 시간 동안 실행될 때도 언구 로그의 양은 급격히 증가할 수 있다. 트랜잭션이 완료 됐다고 해서 해당 트랜잭션이 생성한 언두 로그를 즉시 삭제하는 것은 아니다.\
A, B, C 트랜잭션이 실행 될 때 B, C 트랜잭션은 완료 되었지만 A는 활성상태일 때, 언두로그는 삭제 되지 않는다.

트랜잭션을 실수로 잘못 사용하였을 경우에 언두 로그에는 데이터가 계속 저장될 것이다. 이렇게 되면 쿼리의 성능이 전반적으로 떨어지게 된다.

때문에 언두 로그의 급증 여부를 모니터링 하는 것이 가장 좋다.

